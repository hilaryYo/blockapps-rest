"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _bignumber=require("bignumber.js"),_api=require("./util/api.util"),_constants=require("./constants");function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,a,o,s){try{var i=e[o](s),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,a)}function _asyncToGenerator(i){return function(){var e=this,s=arguments;return new Promise(function(t,r){var n=i.apply(e,s);function a(e){asyncGeneratorStep(n,t,r,a,o,"next",e)}function o(e){asyncGeneratorStep(n,t,r,a,o,"throw",e)}a(void 0)})}}function getUsers(e,t){return _getUsers.apply(this,arguments)}function _getUsers(){return(_getUsers=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.USERS,r),e.abrupt("return",(0,_api.get)(n,a,(0,_api.setAuthHeaders)(t,r)));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getUser(e,t){return _getUser.apply(this,arguments)}function _getUser(){return(_getUser=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a={username:t.username},o=(0,_api.constructEndpoint)(_api.Endpoint.USER,r,a),e.abrupt("return",(0,_api.get)(n,o,(0,_api.setAuthHeaders)(t,r)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function createUser(e,t){return _createUser.apply(this,arguments)}function _createUser(){return(_createUser=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a={password:t.password},o={username:t.username},s=(0,_api.constructEndpoint)(_api.Endpoint.USER,r,o),e.abrupt("return",(0,_api.postue)(n,s,a,r));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fill(e,t){return _fill.apply(this,arguments)}function _fill(){return(_fill=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a=(0,_api.getNodeUrl)(r),o={username:t.username,address:t.address},s=(0,_api.constructEndpoint)(_api.Endpoint.FILL,r,o),e.abrupt("return",(0,_api.postue)(a,s,n,(0,_api.setAuthHeaders)(t,r)));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getCreateArgs(e,t){return{payload:{contract:e.name,src:e.source,args:e.args,chainid:e.chainid,metadata:(0,_api.constructMetadata)(t,e.name)},type:_constants.TxPayloadType.CONTRACT}}function createContract(e,t,r){return _createContract.apply(this,arguments)}function _createContract(){return(_createContract=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=getCreateArgs(r,n),o={txs:[a]},e.next=4,sendTransactions(t,o,n);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function createContractList(e,t,r){return _createContractList.apply(this,arguments)}function _createContractList(){return(_createContractList=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.map(function(e){return getCreateArgs(e,n)}),o={txs:a},e.next=4,sendTransactions(t,o,n);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function blocResults(e,t,r){return _blocResults.apply(this,arguments)}function _blocResults(){return(_blocResults=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o=(0,_api.constructEndpoint)(_api.Endpoint.TXRESULTS,n),e.abrupt("return",(0,_api.post)(a,o,r,(0,_api.setAuthHeaders)(t,n)));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getAccounts(e,t){return _getAccounts.apply(this,arguments)}function _getAccounts(){return(_getAccounts=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.ACCOUNT,r),e.abrupt("return",(0,_api.get)(n,a,(0,_api.setAuthHeaders)(t,r)));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getBalance(e,t){return _getBalance.apply(this,arguments)}function _getBalance(){return(_getBalance=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.address){e.next=6;break}return e.next=4,getKey(t,r);case 4:a=e.sent,n=a.address;case 6:return e.next=8,getAccounts(t,_objectSpread({},r,{isAsync:!0,query:{address:n}}));case 8:if(0==(o=e.sent).length)return e.abrupt("return",new _bignumber.BigNumber(0));e.next=11;break;case 11:return e.abrupt("return",new _bignumber.BigNumber(o[0].balance));case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getState(e,t,r){return _getState.apply(this,arguments)}function _getState(){return(_getState=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o={name:r.name,address:r.address},s=(0,_api.constructEndpoint)(_api.Endpoint.STATE,n,o),e.abrupt("return",(0,_api.get)(a,s,(0,_api.setAuthHeaders)(t,n)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getBatchStates(e,t,r){return _getBatchStates.apply(this,arguments)}function _getBatchStates(){return(_getBatchStates=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o=(0,_api.constructEndpoint)(_api.Endpoint.STATES,n),s=r||[],e.abrupt("return",(0,_api.post)(a,o,s,(0,_api.setAuthHeaders)(t,n)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getCallArgs(e,t){var r=e.contract,n=e.method,a=e.args,o=e.value,s=e.chainid,i=o instanceof _bignumber.BigNumber?o.toFixed(0):o;return{payload:{contractName:r.name,contractAddress:r.address,chainid:s,value:i,method:n,args:a,metadata:(0,_api.constructMetadata)(t,r.name)},type:_constants.TxPayloadType.FUNCTION}}function call(e,t,r){return _call.apply(this,arguments)}function _call(){return(_call=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=getCallArgs(r,n),o={txs:[a]},e.next=4,sendTransactions(t,o,n);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function callList(e,t,r){return _callList.apply(this,arguments)}function _callList(){return(_callList=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.map(function(e){return getCallArgs(e,n)}),o={txs:a},e.next=4,sendTransactions(t,o,n);case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sendTransactions(e,t,r){return _sendTransactions.apply(this,arguments)}function _sendTransactions(){return(_sendTransactions=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o=(0,_api.constructEndpoint)(_api.Endpoint.SEND,n),e.abrupt("return",(0,_api.post)(a,o,r,(0,_api.setAuthHeaders)(t,n)));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getSendArgs(e,t){return{payload:e,type:_constants.TxPayloadType.TRANSFER}}function send(e,t,r){return _send.apply(this,arguments)}function _send(){return(_send=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=getSendArgs(r,n),o={txs:[a]},e.abrupt("return",sendTransactions(t,o,n));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getKey(e,t){return _getKey.apply(this,arguments)}function _getKey(){return(_getKey=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.KEY,r),e.abrupt("return",(0,_api.get)(n,a,(0,_api.setAuthHeaders)(t,r)));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function createKey(e,t){return _createKey.apply(this,arguments)}function _createKey(){return(_createKey=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.KEY,r),o={},e.abrupt("return",(0,_api.post)(n,a,o,(0,_api.setAuthHeaders)(t,r)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function search(e,t,r){return _search.apply(this,arguments)}function _search(){return(_search=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o={name:r.name},s=(0,_api.constructEndpoint)(_api.Endpoint.SEARCH,n,o),e.abrupt("return",(0,_api.get)(a,s,(0,_api.setAuthHeaders)(t,n)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function searchWithContentRange(e,t,r){return _searchWithContentRange.apply(this,arguments)}function _searchWithContentRange(){return(_searchWithContentRange=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s,i,u,c,p,_,g,d,l,f,h,y,m,E,x,b,v,R;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o={name:r.name},s=(0,_api.constructEndpoint)(_api.Endpoint.SEARCH,n,o),i=_objectSpread({},n.headers,{Prefer:"count=exact"}),u=_objectSpread({},n,{headers:i,getFullResponse:!0}),e.next=7,(0,_api.get)(a,s,(0,_api.setAuthHeaders)(t,u));case 7:if(c=e.sent,p=c.data,_=c.headers,g=_["content-range"],d=g.split("/"),l=_slicedToArray(d,2),f=l[0],h=l[1],y=parseInt(h,10),"*"===f)return m={count:y},e.abrupt("return",{data:p,contentRange:m});e.next=16;break;case 16:return E=f.split("-").map(function(e){return parseInt(e,10)}),x=_slicedToArray(E,2),b=x[0],v=x[1],R={start:b,end:v,count:y},e.abrupt("return",{data:p,contentRange:R});case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getChains(e,t){return _getChains.apply(this,arguments)}function _getChains(){return(_getChains=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.CHAIN,{config:r.config,chainIds:t}),e.abrupt("return",(0,_api.get)(n,a,r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function createChain(e,t){return _createChain.apply(this,arguments)}function _createChain(){return(_createChain=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.CHAIN,r),e.next=4,(0,_api.post)(n,a,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function createChains(e,t){return _createChains.apply(this,arguments)}function _createChains(){return(_createChains=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.CHAINS,r),e.next=4,(0,_api.post)(n,a,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function uploadExtStorage(e,t){return _uploadExtStorage.apply(this,arguments)}function _uploadExtStorage(){return(_uploadExtStorage=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.EXT_UPLOAD,r),e.next=4,(0,_api.post)(n,a,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function attestExtStorage(e,t){return _attestExtStorage.apply(this,arguments)}function _attestExtStorage(){return(_attestExtStorage=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.EXT_ATTEST,r),e.next=4,(0,_api.post)(n,a,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function verifyExtStorage(e,t,r){return _verifyExtStorage.apply(this,arguments)}function _verifyExtStorage(){return(_verifyExtStorage=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o={contractAddress:r.address},s=(0,_api.constructEndpoint)(_api.Endpoint.EXT_VERIFY,n,o),e.abrupt("return",(0,_api.get)(a,s,(0,_api.setAuthHeaders)(t,n)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function downloadExtStorage(e,t,r){return _downloadExtStorage.apply(this,arguments)}function _downloadExtStorage(){return(_downloadExtStorage=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o={contractAddress:r.address},s=(0,_api.constructEndpoint)(_api.Endpoint.EXT_DOWNLOAD,n,o),e.abrupt("return",(0,_api.get)(a,s,(0,_api.setAuthHeaders)(t,n)));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function listExtStorage(e,t,r){return _listExtStorage.apply(this,arguments)}function _listExtStorage(){return(_listExtStorage=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,o,s,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,_api.getNodeUrl)(n),o=r.limit,s=r.offset,i={limit:o,offset:s},u=(0,_api.constructEndpoint)(_api.Endpoint.EXT_LIST,n,i),e.abrupt("return",(0,_api.get)(a,u,(0,_api.setAuthHeaders)(t,n)));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pingOauth(e,t){return _pingOauth.apply(this,arguments)}function _pingOauth(){return(_pingOauth=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,_api.getNodeUrl)(r),a=(0,_api.constructEndpoint)(_api.Endpoint.KEY,r),e.next=4,(0,_api.get)(n,a,(0,_api.setAuthHeaders)(t,r));case 4:return o=e.sent,e.abrupt("return",o.status);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _default={getAccounts:getAccounts,getBalance:getBalance,getUsers:getUsers,getUser:getUser,createUser:createUser,getCreateArgs:getCreateArgs,createContract:createContract,createContractList:createContractList,fill:fill,blocResults:blocResults,getState:getState,getBatchStates:getBatchStates,getCallArgs:getCallArgs,call:call,callList:callList,getSendArgs:getSendArgs,send:send,sendTransactions:sendTransactions,getKey:getKey,createKey:createKey,search:search,searchWithContentRange:searchWithContentRange,getChains:getChains,createChain:createChain,createChains:createChains,uploadExtStorage:uploadExtStorage,attestExtStorage:attestExtStorage,verifyExtStorage:verifyExtStorage,downloadExtStorage:downloadExtStorage,listExtStorage:listExtStorage,pingOauth:pingOauth};exports.default=_default;
//# sourceMappingURL=api.js.map
